/*
 * Copyright (c) 2019 by European Commission
 *
 * Licensed under the EUPL, Version 1.2 or - as soon they will be
 * approved by the European Commission - subsequent versions of the
 * EUPL (the "Licence");
 * You may not use this work except in compliance with the Licence.
 * You may obtain a copy of the Licence at:
 * https://joinup.ec.europa.eu/page/eupl-text-11-12
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the Licence is distributed on an "AS IS" basis,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 * implied.
 * See the Licence for the specific language governing permissions and
 * limitations under the Licence
 */
package eu.eidas.node.logging;

import eu.eidas.auth.commons.EidasStringUtil;
import eu.eidas.auth.commons.protocol.IAuthenticationRequest;
import eu.eidas.auth.commons.protocol.IAuthenticationResponse;
import eu.eidas.auth.commons.protocol.eidas.LevelOfAssurance;
import eu.eidas.auth.commons.protocol.eidas.impl.EidasAuthenticationRequest;
import eu.eidas.auth.engine.DefaultProtocolEngineFactory;
import eu.eidas.auth.engine.ProtocolEngineI;
import eu.eidas.auth.engine.metadata.EidasMetadataParametersI;
import eu.eidas.auth.engine.metadata.MetadataClockI;
import eu.eidas.auth.engine.metadata.MetadataFetcherI;
import eu.eidas.auth.engine.metadata.MetadataSignerI;
import eu.eidas.auth.engine.metadata.MetadataUtil;
import eu.eidas.engine.exceptions.EIDASMetadataException;
import eu.eidas.engine.exceptions.EIDASSAMLEngineException;
import eu.eidas.node.BeanProvider;
import eu.eidas.node.auth.connector.AUCONNECTOR;
import eu.eidas.node.auth.connector.AUCONNECTORSAML;
import eu.eidas.node.auth.service.AUSERVICE;
import eu.eidas.node.auth.service.AUSERVICESAML;
import eu.eidas.node.auth.util.tests.TestingConstants;
import eu.eidas.node.connector.ConnectorControllerService;
import eu.eidas.node.service.ServiceControllerService;
import eu.eidas.node.utils.PropertiesUtil;
import org.junit.Assert;
import org.junit.Test;
import org.mockito.Matchers;
import org.mockito.Mockito;
import org.opensaml.core.xml.schema.XSString;
import org.opensaml.core.xml.schema.impl.XSStringBuilder;
import org.opensaml.saml.ext.saml2mdattr.EntityAttributes;
import org.opensaml.saml.ext.saml2mdattr.impl.EntityAttributesBuilder;
import org.opensaml.saml.saml2.core.Attribute;
import org.opensaml.saml.saml2.core.impl.AttributeBuilder;
import org.opensaml.saml.saml2.metadata.EntityDescriptor;
import org.opensaml.saml.saml2.metadata.Extensions;
import org.opensaml.saml.saml2.metadata.impl.EntityDescriptorBuilder;
import org.opensaml.saml.saml2.metadata.impl.ExtensionsBuilder;
import org.springframework.context.ApplicationContext;
import org.springframework.test.util.ReflectionTestUtils;

import java.util.Map;

import static org.mockito.Matchers.any;
import static org.mockito.Matchers.anyString;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

/**
 * Tests for the {@link MessageLoggerUtils}.
 *
 * @since 2.3
 */
public class MessageLoggerUtilsTest {

    private static String SAML_TOKEN_REQUEST =
            "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHNhbWwycDpBdXRoblJlcXVlc3QgeG1sbnM6c2FtbDJwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiB4bWxuczpzYW1sMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiIgeG1sbnM6c3Rvcms9InVybjpldTpzdG9yazpuYW1lczp0YzpTVE9SSzoxLjA6YXNzZXJ0aW9uIiB4bWxuczpzdG9ya3A9InVybjpldTpzdG9yazpuYW1lczp0YzpTVE9SSzoxLjA6cHJvdG9jb2wiIEFzc2VydGlvbkNvbnN1bWVyU2VydmljZVVSTD0iaHR0cDovL3NwLmxvY2FsOjkwOTAvU1AvUmV0dXJuUGFnZSIgQ29uc2VudD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmNvbnNlbnQ6dW5zcGVjaWZpZWQiIERlc3RpbmF0aW9uPSJodHRwOi8vcGVwcy5sb2NhbDo5MDkwL1BFUFMvU2VydmljZVByb3ZpZGVyIiBGb3JjZUF1dGhuPSJ0cnVlIiBJRD0iX2QwNDhjYjMxNzgxMzg0NWIzMmE3YTJiNzVmM2JhZDU5IiBJc1Bhc3NpdmU9ImZhbHNlIiBJc3N1ZUluc3RhbnQ9IjIwMTEtMTEtMzBUMTY6MDk6NTcuODI0WiIgUHJvdG9jb2xCaW5kaW5nPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YmluZGluZ3M6SFRUUC1QT1NUIiBQcm92aWRlck5hbWU9IkRFTU8tU1AiIFZlcnNpb249IjIuMCI+PHNhbWwyOklzc3VlciBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSI+aHR0cDovL1MtUEVQUy5nb3YueHg8L3NhbWwyOklzc3Vlcj48ZHM6U2lnbmF0dXJlPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMSIvPjxkczpSZWZlcmVuY2UgVVJJPSIjX2QwNDhjYjMxNzgxMzg0NWIzMmE3YTJiNzVmM2JhZDU5Ij48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PC9kczpUcmFuc2Zvcm1zPjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIvPjxkczpEaWdlc3RWYWx1ZT5LeGhHTnJtdVN3MGxaVXBiUHpldm9EOUk0V3M9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48L2RzOlNpZ25lZEluZm8+PGRzOlNpZ25hdHVyZVZhbHVlPkg0Rng0QkRaMXJFQWwvS09YOUpIM1dHcCtheWVGci9GTGtLOE5kU2hycE1JNXJXL2lvTFY4ZlV5UXFnMlY5L0tiQkF5cVhaTDFNM0loWjFCMDNuaXZhR3FXUVdiUklOT2syMStvMzZLcDI4a3JRQ2ZqdkhhVVNsK0FHNXVpZGFJT0FSZUdPQkRuQ1VKRkd6aEUvdzc1ZXNaMm5KcmJrR2NVYklRamlJbHBqMExvbnZyUWp0bzgveWpkMFJNNW01SUpDRCtCb0VUZ2tZNkxmajR0UXgzYjVkRytqb1JyU3g4R2ZiQ1Y1TXZwcTRndHgyd0cxSHVEcllDWUE2NUhxSkhJbE5xTWRMeG1BRXEzdkNhMjdMQU9FRWU0ZkxDc2hyVW0ySUZWSGVhWWVQV2NONUhSRStVRGt5MVllQ1pSbWlsa2graUFwS3UvZExqQzdxcXpLaUt1Zz09PC9kczpTaWduYXR1cmVWYWx1ZT48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlESnpDQ0FnOENCRXVvbmJJd0RRWUpLb1pJaHZjTkFRRUZCUUF3V0RFTE1Ba0dBMVVFQmhNQ1JWTXhEakFNQmdOVkJBZ01CVk53DQpZV2x1TVE4d0RRWURWUVFIREFaTllXUnlhV1F4RGpBTUJnTlZCQW9NQlVsdVpISmhNUmd3RmdZRFZRUUREQTlzYjJOaGJDMWtaVzF2DQpMV05sY25Rd0hoY05NVEF3TXpJek1UQTFNek00V2hjTk1UQXdOakF4TVRBMU16TTRXakJZTVFzd0NRWURWUVFHRXdKRlV6RU9NQXdHDQpBMVVFQ0F3RlUzQmhhVzR4RHpBTkJnTlZCQWNNQmsxaFpISnBaREVPTUF3R0ExVUVDZ3dGU1c1a2NtRXhHREFXQmdOVkJBTU1EMnh2DQpZMkZzTFdSbGJXOHRZMlZ5ZERDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSmZkUTEvbWtNOXNxcWFiDQpyaThxcXFYNHMwSjZVRUVYeUYrMEFqTFU4UkM0V01lWUZTWjV0ZndueUxzb1hZMC85YlpMWG5CeFNpYlFZYWY0U25wWkpobFZBNHNVDQowZDhxeUVXQTJPdlhHRENtN3VzcEdIRzNDUlFhN2ZwSHNtSG1mSUFxaG85WERsd3B3SmR4NWdLNEVkYzZhQXJjTVFmanFNaHkxczFuDQo2T2YxaTFsTUdHc0dyRVJJUlk3YmlJUXUvOG5JVGJISDE4c1VBWk1HMXUvUTBBdmk5TzNMV3lzd0hYVW91WjgxOGZXd0c2eHJ1Mk41DQp5NnZ0Vk8vU0wzZG9SU2RxWWtFbXM5M1RneFR0YUtnOFhOZTI0emhOVHRlNm52V0xhS2VzaTJLelpHQzU3SFU0N0hCRkVzOE5Xazd6DQo5QkRmOHVMeVB6OVZEYWh3Vkt6TXRvOENBd0VBQVRBTkJna3Foa2lHOXcwQkFRVUZBQU9DQVFFQWdwdVJlWFE3RHNmZG9lNXp6eTJGDQo2a24xcXF0TWtSR3NCUEtuREZDSS9Ha0lacEJpcWxmd2RoNnNpcG5GS1dmS0VEbFBLTjFrRWhia0RSMkdBMUNwNEY0WlNML0h1bVpNDQpwV2FiUmhEeGhUUHZISUZiYlNoUERKWTkzK2p3L3lRZWFXZ011aHczV3pkSDlUclZvUlpIMFE3c0cxcElKbzUvNklvZ0lad0Z2SkhUDQovTkR1dEttdXJVNkx3OFZuZGU4UGZuUWQrRlRFaHowU0VHeUtrV2pBdWhHYkpmc2VCeS96M0wrTUpxMXJkU1E5UEY3d1hEdldOekpxDQp5YU5CVVdXQlYxVHNrdmtOWlhjYWd1cm9WUHkyWGhBMWFpeGxBYWpXRVhMazZVdWo1VVlxYWxyVi9yZU5ZdkR2WTBCVjJDSW41MXI3DQpQcG04SUZWVGs4bVlmWDgvanc9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1sMnA6RXh0ZW5zaW9ucz48c3Rvcms6UXVhbGl0eUF1dGhlbnRpY2F0aW9uQXNzdXJhbmNlTGV2ZWw+Mzwvc3Rvcms6UXVhbGl0eUF1dGhlbnRpY2F0aW9uQXNzdXJhbmNlTGV2ZWw+PHN0b3JrOnNwU2VjdG9yPkRFTU8tU1AtU0VDVE9SPC9zdG9yazpzcFNlY3Rvcj48c3Rvcms6c3BJbnN0aXR1dGlvbj5ERU1PLVNQPC9zdG9yazpzcEluc3RpdHV0aW9uPjxzdG9yazpzcEFwcGxpY2F0aW9uPkRFTU8tU1AtQVBQTElDQVRJT048L3N0b3JrOnNwQXBwbGljYXRpb24+PHN0b3JrOnNwQ291bnRyeT5QVDwvc3Rvcms6c3BDb3VudHJ5PjxzdG9ya3A6ZUlEU2VjdG9yU2hhcmU+dHJ1ZTwvc3RvcmtwOmVJRFNlY3RvclNoYXJlPjxzdG9ya3A6ZUlEQ3Jvc3NTZWN0b3JTaGFyZT50cnVlPC9zdG9ya3A6ZUlEQ3Jvc3NTZWN0b3JTaGFyZT48c3RvcmtwOmVJRENyb3NzQm9yZGVyU2hhcmU+dHJ1ZTwvc3RvcmtwOmVJRENyb3NzQm9yZGVyU2hhcmU+PHN0b3JrcDpSZXF1ZXN0ZWRBdHRyaWJ1dGVzPjxzdG9yazpSZXF1ZXN0ZWRBdHRyaWJ1dGUgTmFtZT0iaHR0cDovL3d3dy5zdG9yay5nb3YuZXUvMS4wL2dpdmVuTmFtZSIgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDp1cmkiIGlzUmVxdWlyZWQ9InRydWUiLz48c3Rvcms6UmVxdWVzdGVkQXR0cmlidXRlIE5hbWU9Imh0dHA6Ly93d3cuc3RvcmsuZ292LmV1LzEuMC9lSWRlbnRpZmllciIgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDp1cmkiIGlzUmVxdWlyZWQ9InRydWUiLz48L3N0b3JrcDpSZXF1ZXN0ZWRBdHRyaWJ1dGVzPjxzdG9ya3A6QXV0aGVudGljYXRpb25BdHRyaWJ1dGVzPjxzdG9ya3A6VklEUEF1dGhlbnRpY2F0aW9uQXR0cmlidXRlcz48c3RvcmtwOkNpdGl6ZW5Db3VudHJ5Q29kZT5MTzwvc3RvcmtwOkNpdGl6ZW5Db3VudHJ5Q29kZT48c3RvcmtwOlNQSW5mb3JtYXRpb24+PHN0b3JrcDpTUElEPkRFTU8tU1A8L3N0b3JrcDpTUElEPjwvc3RvcmtwOlNQSW5mb3JtYXRpb24+PC9zdG9ya3A6VklEUEF1dGhlbnRpY2F0aW9uQXR0cmlidXRlcz48L3N0b3JrcDpBdXRoZW50aWNhdGlvbkF0dHJpYnV0ZXM+PC9zYW1sMnA6RXh0ZW5zaW9ucz48L3NhbWwycDpBdXRoblJlcXVlc3Q+";

    private static String SAML_TOKEN_RESPONSE =
            "PHNhbWwycDpSZXNwb25zZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIgeG1sbnM6ZWlkYXM9Imh0dHA6Ly9laWRhcy5ldXJvcGEuZXUvYXR0cmlidXRlcy9uYXR1cmFscGVyc29uIiB4bWxuczpzYW1sMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiIgeG1sbnM6c2FtbDJwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIENvbnNlbnQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjb25zZW50Om9idGFpbmVkIiBEZXN0aW5hdGlvbj0iaHR0cDovL2NlZi1laWQtYnVpbGQtMTo4MDgwL0VpZGFzTm9kZS9Db2xsZWFndWVSZXNwb25zZSIgSUQ9Il83UE9sbTBYRzZSVWxydjY3QXJDVk1lNGNqYzRJaklPNVMyZmU3NC0weVliUFJxYmpKWWwtdjJoRTRsNnNxQTIiIEluUmVzcG9uc2VUbz0iX0JXdWpoLVNZSGRZN3FUMzVDWFo4eS55azV0U0s3OTN6UW9pYXZUcVhlLmlfQXVWdzBmOVJUT0VRT2loZW5TdiIgSXNzdWVJbnN0YW50PSIyMDE5LTA1LTI0VDEwOjAwOjMyLjQwNVoiIFZlcnNpb249IjIuMCI+PHNhbWwyOklzc3VlciBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSI+aHR0cDovL2NlZi1laWQtYnVpbGQtMTo4MDgwL0VpZGFzTm9kZS9TZXJ2aWNlTWV0YWRhdGE8L3NhbWwyOklzc3Vlcj48ZHM6U2lnbmF0dXJlPgo8ZHM6U2lnbmVkSW5mbz4KPGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4KPGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGE1MTIiLz4KPGRzOlJlZmVyZW5jZSBVUkk9IiNfN1BPbG0wWEc2UlVscnY2N0FyQ1ZNZTRjamM0SWpJTzVTMmZlNzQtMHlZYlBScWJqSllsLXYyaEU0bDZzcUEyIj4KPGRzOlRyYW5zZm9ybXM+CjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+CjwvZHM6VHJhbnNmb3Jtcz4KPGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTUxMiIvPgo8ZHM6RGlnZXN0VmFsdWU+M3RTRGFPYitNQ1hLbVNiU1N6STEwS2ZBckgxV2JFaTFSU3RadFdhRklWcDYyMjZKeDlnUFhGYmxLVm5kLy94TjlBZ3U4WURBbVluUwpHK0E2RHFSL3dRPT08L2RzOkRpZ2VzdFZhbHVlPgo8L2RzOlJlZmVyZW5jZT4KPC9kczpTaWduZWRJbmZvPgo8ZHM6U2lnbmF0dXJlVmFsdWU+CmNxam9mcVluZnhuV1VtbHc1WG9SOGdoTUIrZnRyRGVvaWhzbFk3dWdZSjdybGNRVWxtcTdQRzB6S1lDelUxZzFmRSt4Rjg2OCtCcnYKWXc0MVNjK1ltTm40dGlOTWFkd2x1bHlZL1hoalFwbWRwbFhnVUk0NWlYN1BNM2lTcDN3V0Z5ZW9NSGhyaTBaSHBwS1hDYm5JcW5DZQpuYUJMay9RSVQvV1VPT0JMbmx3bWZpeWU4ZVhkV1Q3Ri95V3laZVZaZzFjbExGTy84MjlsUjc2MWNHUFFJb0pVTUlRSGNHVXBOeURpCmFxaWtyb0RkOXVualpUVzU1NWlwTlNRdjNaQ2VxUlc3SS9yZ3F5aXFkR2NPVUtWMm1odXdZM0tTWGJnZzIvOG5DNDRnTTFscFljRmwKWFFHdWQ2UzN6dmFhR1M4QlREZkYvYm12dXlKS2g0QjRPT2dXQWJaK3FSV0w2aW1rY1RPTXNsdi9HZnNmNzRLWnl4NjJOVFNqVzNGZQpISEFYcDhrdFpSRUtQZTc0TDl2V2ZHY2Z4Y1BUMXBKa3J0OWRhTFhtcTUvckE1ZXlIdTBMYytCTDliaHhWN0dicWJWK2lxWGpPanJsCkVvK3E1eUdBc2NVZ01FWUtLRytKbEFRVjFJbTRrRzhBSDRDcURGaTZQWXpTbUFmMHJzS1BsNFVaN1V3VkFXaG9tNTFLZWxrNmErY3MKV1RNTXpYZUlHK2NlVmlsckxyODdzOWtmUlY2OWhYamxiZnR6NmhyR2F1Q1ZxUmF5VjByb3gwemxoUG1oQ0JLekN5c0ROU1psenZZKwo3KzZ4QW5UbHR3MjQ4RHFHUFpvdzJCdWIySWV3UFM2V2l4b3owUjNkWW8zSjN2UmtqUlVabkJiOW5iWU9aRkJETU05RnlmbGlCZzA9CjwvZHM6U2lnbmF0dXJlVmFsdWU+CjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUZUVENDQXpVQ0JGVEkrSDB3RFFZSktvWklodmNOQVFFTkJRQXdhekVMTUFrR0ExVUVCaE1DUTBFeEN6QUpCZ05WQkFnTUFrVlYKTVFzd0NRWURWUVFIREFKRlZURU9NQXdHQTFVRUNnd0ZRMUJGVUZNeERqQU1CZ05WQkFzTUJWTlVUMUpMTVNJd0lBWURWUVFEREJsagpjR1Z3Y3kxallTMWtaVzF2TFdObGNuUnBabWxqWVhSbE1CNFhEVEUxTURFeU9ERTBOVFUxTjFvWERURTJNREV5T0RFME5UVTFOMW93CmF6RUxNQWtHQTFVRUJoTUNRMEV4Q3pBSkJnTlZCQWdNQWtWVk1Rc3dDUVlEVlFRSERBSkZWVEVPTUF3R0ExVUVDZ3dGUTFCRlVGTXgKRGpBTUJnTlZCQXNNQlZOVVQxSkxNU0l3SUFZRFZRUUREQmxqY0dWd2N5MWpZUzFrWlcxdkxXTmxjblJwWm1sallYUmxNSUlDSWpBTgpCZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUFoMHFCRUJIaHZRWW55TTN6UGJBbm9KcnZzN00rdzkzS21LYkJFRlNLCkZHUkJKSGRib2Y2dE40czIyMHZTSE4yU2FtZ25uVDBLcVl5ZnlCMHhIWjBqb3ZsOVI5R1NucE1lQm90WkkrelpZQnVpN0tlaXpEVjIKQ1UzUmUyZ2RjenVlOTNFRDBoM3JGRGliR21sc04rdk4zZDVqalRIb3NoZldXeEtwbEh0dlcyTjlCdGlwS3dYVU5lMzlGajBPVllBTAo3UzRVVFRxS3NMRlJnS0J4WXAzcXdjSHpPWE0xeFFJbjkweHpCVC9iQllsUGhDdjRTbGhXbzFsZVYzZmgyYlN3NlgwYkZkbVJlOVZUCjhWR2xjT1RwT0h2TUhvZ0pVQzZZdGVRd01zYUxQWHJTSXEzZFBMUGZUVGhoc1d2cDZkY2x3bkFYUXE5dTR5dVRYR3JaMkp6VzdYaUsKNDdFNFJ2NDIrcDdNYlEvVTBGbXVvdlV1VGVRai9rZXdSUFI5ZDBYOVYwcVJkbDFnb1VSR2tLcUxmN01GMFJEZFgwdDhNWUNxVGN4ZwpibUlud1U3ZUN2cmFPeWtiQmVUQnlTUTNSWkV0d1l2STVOU3NxS2EwVDFMWXY0MVhGUzJ3Qk5LbHhIWG5Dd1VXREQzRStUVTBmcHl1CkRYTWNjY2pwak4rbU9MdEhPcGYzaGZ4ZTd5NHU2RnlLN1N5amtTOXZST3ZaNnpteXdCS25qcGtsemxBcUt1YnlLZktBR1M4eVVFcFMKallsZGZoOWtlWUxuWEppVG8vS05TaCtsKzhFQWdhRHM3SWpGVUc4VHowK3o2NURRejBQZGtTUjdCWHZRL2hCdUlVSTU3YmMwZElCMApPM1BMMkRxajdLdXlNY015SktmcFV1a1BtZE1tNm9kMVBXRUNBd0VBQVRBTkJna3Foa2lHOXcwQkFRMEZBQU9DQWdFQUJFTmhXdXVKCnBoRDEzeFdiWVlzckc1d3lubFNrZDFMdUxTWkp1cEtuaE9taXh6VXJPVnhMTDdLdEV0VXNXc3NtN016S2xqSHJjUXlVYUd1eENlZjMKRVNnd2REa2RQa3J0U0duYm5heTI2WURxN1R4UzVIVTR0MlFtRkZTV0x0RUMyejZnR1BUeDBzQjZxNnB0QzkvNUFjVEhNcXROMmdPRgp2TFp2enU4QUt1dGNXeFNFVE9HaDluY29uU3A4UXd0c3hxaTZUdnFiYmF4VytKTDN6THBHbHk4anlnZ0lJeVJvTERuRmZLRE9oYkNYClVPb3JUbUhLRTQ3RmtWdU5ucGRSNHExVUlXT3RvbXRYOVAvTUFLZGJmOXJNYXVZWGx3eFdQRStHUU0vNnd2eXdnTjV6REVsNjAvc1oKd1V5RCt5ZW4rVlkwN2tVcGRCWTFwTnpOSnd2MVU1M0JYcklzOGJMenV0T2ZpWi93bGdNcytzWWxldEJoVkN6QVVjS3ZrWlJJbDlkRAoyR2FPWW5RZVZWQlJldEtIdjBPNTZHZkQrcnNDdGhEeUwrY0tuSlJJMU9tS0pKeG04MCsxazRrN2VmTFU1Y2l4VFpaYk5pTHg1bDhzCkczUjRZWiszbVpjVm4rUUpCMHNWbDBqcE4xRzNucnVCZTJpaGcwVVhBTFU0WWdrME14M1dYVmg5ZTNuRmdFVUdUdDNoMkZEQy8ybDMKNWVqbnk3SWtXeko0VVhVVE9nS3RJZnFGVlY2QkVNTDEyU0VJdnhGbnFHZFpEbnkycXhLUnhkbXJUQTN0T3BaNGpJS0tWZkduR1EwZApVc1d3V1kyVk8vVS9IcDJuTHFrNzNiWG9kdlZMb1EvV1YyYnFvMUh5VEVoVzRUYXNad0c0ZTBqeDloVzIzS0thUXJjPTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1sMnA6U3RhdHVzPjxzYW1sMnA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIi8+PHNhbWwycDpTdGF0dXNNZXNzYWdlPnVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2Vzczwvc2FtbDJwOlN0YXR1c01lc3NhZ2U+PC9zYW1sMnA6U3RhdHVzPjxzYW1sMjpFbmNyeXB0ZWRBc3NlcnRpb24+PHhlbmM6RW5jcnlwdGVkRGF0YSB4bWxuczp4ZW5jPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyMiIElkPSJfMGM1NDZkYTM5NWYzNTIwMjUwZWY5ZjNlZjgxMmIyMjgiIFR5cGU9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI0VsZW1lbnQiPjx4ZW5jOkVuY3J5cHRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDA5L3htbGVuYzExI2FlczI1Ni1nY20iLz48ZHM6S2V5SW5mbz48eGVuYzpFbmNyeXB0ZWRLZXkgSWQ9Il82YmZkYzQ4NjMxNmYzYmM0MWNjOTU3Nzk0NmU1YTI0MSI+PHhlbmM6RW5jcnlwdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3JzYS1vYWVwLW1nZjFwIj48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiLz48L3hlbmM6RW5jcnlwdGlvbk1ldGhvZD48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlGVFRDQ0F6VUNCRlRJL0lnd0RRWUpLb1pJaHZjTkFRRU5CUUF3YXpFTE1Ba0dBMVVFQmhNQ1EwRXhDekFKQmdOVkJBZ01Ba1ZWCk1Rc3dDUVlEVlFRSERBSkZWVEVPTUF3R0ExVUVDZ3dGVTFCRlVGTXhEakFNQmdOVkJBc01CVk5VVDFKTE1TSXdJQVlEVlFRRERCbHoKY0dWd2N5MWpZUzFrWlcxdkxXTmxjblJwWm1sallYUmxNQjRYRFRFMU1ERXlPREUxTVRNeE1sb1hEVEUyTURFeU9ERTFNVE14TWxvdwphekVMTUFrR0ExVUVCaE1DUTBFeEN6QUpCZ05WQkFnTUFrVlZNUXN3Q1FZRFZRUUhEQUpGVlRFT01Bd0dBMVVFQ2d3RlUxQkZVRk14CkRqQU1CZ05WQkFzTUJWTlVUMUpMTVNJd0lBWURWUVFEREJsemNHVndjeTFqWVMxa1pXMXZMV05sY25ScFptbGpZWFJsTUlJQ0lqQU4KQmdrcWhraUc5dzBCQVFFRkFBT0NBZzhBTUlJQ0NnS0NBZ0VBaEZYQy9HREtqSEEwYVh3VSt4SXYrMkd5ZlNqUTJMMVpTMWFzQzVBWQpPTGExUEMyVFdpbGpiT2oxdlJYR2xOWEc0dWU5MW5Ra3BNQk5nM25NbVp0ZGhQMnZmRXRUKzlWMklOUVIrMWFROHBsUEdXTklPWDFPCjVOWi9GMk0vZGFBWjJLM1krV1NLTGluN0ZDZEJMNkJ3MElHRm1RVWVibElydW1Nb2VScFFoWEJmckRIeUZXL296TmVCNk05eDJiVEQKbWsvaGpKTzhsL2F1eHNQall6VTIrckVOUytrRUtyMTBIUnk4TVRxdGZjcVZmdDVibENBVU9lRGN0dnNmLzVzMzdKSzJNQkdqZ1g2WAptY2hMUXlsT3BVWnJCbzdjTlRmYzc3UmpvYmRnTjVyV1V5WjhXZUVZSHRmeVVvK25GN0RIUDJldWl1aHVlRlc3R2luZCtNcmNBdWRJCkpJNXIyN3g0amhuZXl1bDFhNU9XYkdVUDg0bE9vSXB6Q2t2RTB3N0hicEl0RHhibnVYMDlLQm1tOGxLVWluZ0I1Q2FxRzVEK0FQQ1cKVDNlbW8xSElrTFgzSnE4T0xYTnU3YzlqUEIxeEdrNGI2WkMyZmhDTHd2djM3YkFhaFdaODFXa3F6V0xhWnB5QUtaK3ZSQ2E3V010dApIZmhWRUptRVUvd0NnZnZ2MmwxbXZDejYxSDZBUVd6RWQ4Wkx3aVpubGpnREV0eHE4c1JOWkhRVlB2Qm5DOVRLeXp5NkQxLytzWjdSCjhwNEF4RkhYNVV4RytxRXRFaXo1cVhGc3dYVThnQnNLcERPOWNHNm43QzhCZzh1aHN4MVRmV0plb2UxbXRKcEtUQXZKYnFFL08yYWsKUU1IdTBDMkQrZm91M2p6V2pvRGZyTUppKzlDVnFzeUlDUmNDQXdFQUFUQU5CZ2txaGtpRzl3MEJBUTBGQUFPQ0FnRUFieXd1bStwWQp0clhuUm10STJ6cnVuN0p1bTdVcHhTbFZqVzFNVXZ0MHZaSE5ndW5Ba0RpdkYxZU9Yc1hRUjFib1hkanN1dlJ3M0VSTWhkcGlibjdJCm12RkFtTXJZTWV6NVBORXVzcVErcHpJejJPUGE3SklqZW14NmVtWlRvVUtoSjVpcWpEbEwrSjVPN292NitGcmpqbFJqZlBzTVdKZEMKenUzTmswVEJYMXBNMlBXRHMyTm9JVENPak1JOGp2K1VyOWdxSDhtb3BZZjFTRjk0UmpOS3FpU1F4QWVYcjBCTTZhV2JaemVUWFA1egpNd2xibTBpY3FBRjI2WU1aZ0V5cENSM1VoSm1saGdGVmQvZlB1YW82bGFXUzV0c0tvWWhHWHo3bGxoZVkxZ1BOVnAyOHBFNlBrRDNTCmVnYlp1MlJNOWlyeTBHK3Y0Nk8rZ3dZREl1WEN5QTlCUmFnaVNlazROTjlOb0hGckxFdGJONVBseGNWN1Vhdkl4VmMrcWwvRFRxLzkKMmQvRU56YXkvTVYxa0YyWkhKeitUZU9FT1dYZTBtRXJOMklEdURySjFvWFhBSlpNc1YzY24vRVVuMk5aMWQ4bWhRQjFEcFBJeldjawo4UEt6em84K0VFV014WXJMM3Zqckg5U1BFMFFXMlRuTW92U3Zjb21nOVpxeWQ3OU5DcEprS0N0MkZLc0J6aUtCY0ljam9Gajk4KzlCCmtYZXhpSWlvdHlRS0hLSlNTY0R5NnJ1aGlkVTVDN2ppbndyV0RoVGlFaGtweWNLdmlxVW00MFAzWkNFYkZoeTBJYXNqVitwTjhlZGQKZ2Y0VEJleC9rRjVUZXVSRDBmQlphUWlqb3pkZVZseDRsZWoxU2lpVVpnK2JPTkd2bXJKcmtMTGxycmpmdC83TmRQND08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48eGVuYzpDaXBoZXJEYXRhPjx4ZW5jOkNpcGhlclZhbHVlPkxRRzRzMUFEV2dBK2ZNTXVBdDlnNzNHZ2tjM0VQVDhFWnlQRFUyaHg1ZTN2QjZUalZ5aCtGcCtqMXN2L1BlK0s3eWVpcE1ENTgxZkMKOVUrbmNZczhCOGJWQzU3RGJoVlZnNmNUUkdYemVjajl6TktTWGFFSlRsY0FkVDhSOXMyMHpnZG9sdHRlU28xcjNHZTJueXlPMjU2NwpSUzcwTHpCaVZ4eHJQRXhCcVhyaGlTTUJQaGpGTU40d2QzWmZJdWd1MkFSdnF5SFY3aklkQThneS8zQVN0eTlhYWlwaGJiZ3NiOXg1ClFGR2p3a0RSdFBxWThraGFGS216NnJWaHlpR0pVTW0zN1VmQmxRcXpzcHM1cFlmS0xNZUR5U29tZGpZUE1Lbm5Dd0IxS3BNTUdBYVoKUmlFcVRqQU5tb01vdDc1ZTYzQ0d4MThGaTVIKzc4RWVnSjRKNzlsdjlwelZyZ0JVNmw3NkJLb3hqeXlkTklCNzgyZVRSUmVsSFZzVwo0RXlETFY1WFJsZmttOHNaNS9rdGxiUGZTTktlcDNwbytKcHpjRnp3T3JRcStHWmVFR2RzdVVUR1ZiNUdrcHQ5YUlncWw5UUZCSWJ5CmowSE5PejhtN0FzNHllaVZOTkZWdTZEZ2k1eVFlOVIxbVRSUWtrY2lsSVc1eEQyZU0rcm85VTlUbHdHRW5lMUkxckEwV0xmSXgyMEkKZlZKeVdlWDYxbER4TlVKcWNjV2NGakRmandHTHRDcXR1VDMvTHExbFlWQzFXeGZLMk9HYTNydExmZVQ0dURVV2JpOHpPakNodnNsUgpTck12dVR5OCthc2V0VnZCZlFSdjhRL1FCeVo3L013RVBaSUZndlBFTjhiL0dWdTRrOTVGa1p2WmJNakR4UFRNZ1RUOGFkeE1MbDA9PC94ZW5jOkNpcGhlclZhbHVlPjwveGVuYzpDaXBoZXJEYXRhPjwveGVuYzpFbmNyeXB0ZWRLZXk+PC9kczpLZXlJbmZvPjx4ZW5jOkNpcGhlckRhdGE+PHhlbmM6Q2lwaGVyVmFsdWU+VmRaNmZDVjNabjBObU53NWVaQ1VCTjhlVkI1UUY0aU1Pa1hBRlB6QWhSTkJRMjZ2ditjRVF5cWZOZldiZG5xWW1kbWhZZk9iM0N1UwpPaWtIZU5JQjhXaE9RemlKNEpWQVM5THlacThhSWRZM21qOHFMa21qL3ZGeFROWldqdXZVdHNyYjJEUGI4NGZ1ZFVwbm1OdnVPUWFsCk02MTBiVXgzRDFQeEFaM3h4N2ZQTEpKT3hqNU14U3JIaVpwWnZ4WGsyVlFwU1pMbGZiWnZpcUpuMGdXY1hMcUU0TzZZT0h2OUJFR3EKRG45ckNtTXpUcUdob2pONDdNdG9kVk5qdEFQdkQ5VnlUUmU3NFhZTGM3Z3dWakNOa0paUWpzZXl1TEVHZGVjcUdIRUZLcjg0eUtFKwp1OU1YdnhyY21iOXpiZVNtSTErVHF2cGJCWnFIdzZ6UXpyZjBrdjAvbGU0WjZiakptMVVJUllicVMydVVtc2EwdXN4SmNUbXRYd2tBCmZmbndVUGUvcXlNRCtuY21OYXVZRDNmcTlTZ1RFVEFyREhFWHJ4V2kxK1RMVkZoUkhYOVFFNnF2N29vUjJIalFqU0JkWmwxR3BWMHIKYkZVWEpPbWNjclZrV1BvY0FvMUhYaVVIcTk2QjhCemQ5akhPMFY1eXBTeWZlWERPQzk2U0xHZHJQNzA2RXlrQ2EyRnpUeWdsNyt0cgp4Y3RmYnNTZzh3c3dCa3JSdC8zakIyb1BZT3k1TGZXTEFrNEQ1OVhxTTlHNmExKy9MdDFaS09LNWFmODdUY0VIMzI1QmhWQ0ZobUI4CjNUaWJwcjhPYXNyY2h0NXJMbWJHbVdXSlNPUVZYbERRcGo3a3c0QTRvVmtDeUhJVzE0T2xiK2ZpVHptbFFDYzNuZWI3U0RUSFR2SlcKc2RZeE15K1U0QnFXSUtCKyt2czlianhRc1JXQWhPSEhFR21iamxnd1k3blY2b0QzQmJkSWt1N21rTXlvMmVMZ1UzSGZ3RS9TV1p6TwpZUFQ1MmppNzlsNlBUV0dkbVFVNC9hb1RTNStkR3lta2dwYVdielBNMlhNejczN0xqMHUwam0ycG9IZ29tNEc1M1MzSGY2Vy9yRk9LCmxtbWtmUmw2bW04amR4YjE3TDM5ODdXN3M1NDNmOHVQRDBORjYrY3RyejRTeHZ4dG1HMmVxMkxPbFk5NFBmK2phdVhHRWpRbXVQQkUKZCtXMmpmeEpTdER1dXNia1dXRFBXZ0NqNU1VeDBYd1J1K0U0eGlSRzRYeHpJWUdMOTYvRmp0a0g4S3NVRTdoUEVmMW53RmRueS9xVgpoenRoekJFdW1Wdi9uTWN0ZFpTaXpvQVpMaFBsb1c5bXZ3SWdMRm1pTzV6UmdqT0JVdEFmTHgxcEZXTUQxWEYxWDgySDdERTQ5eEhxCnNYODhJckJ3M1pVNXBFd0t6S2IrZ0hncXhPT2tvUG44MWpDNjZpNEdkZ2FRV3RyMzJkRUEzOGEraHprQ2dkQk9qL1o0Zkd0aEh5RVIKYzN1L21wVlpEYWk5V2NabkZDOGhwWk9HZE42Wkp0b28yTklnTlBYQWRtS1VkR215RTJuUS9LOXFXV2E3M1lGT2c2VklLV2krTCtxQgpoNkNEQU81ek1oa1NrUElTVWpzaHZvdmxNT29YQ0cvaDRueFZ3bzhVYXB1RVRWZmM3eXloQUNBeWJraWg1Zmk2UzZhT09PRUhuV2dnCjBERzdweUV6T1Vra1gzYVZKakd2WEhiZG8zdE9pQU9WTWJXYmViWGNmcHNNRXYrcmVFNHhIN0wwb0NuQ3lUS0E4MGhWTnZxcHFmNk0KeTc0UElHUzhSZkpuUHZkc1hlL2FqTGliMVp5NXc2eVRzWXpISXVDa1B1L3d0TlNscGE1SENxNFVFblpFbU1BWXBHTXBTVDVSMlZ5MwpBZEs5SGtoNE13V2kxbXBnS0NJb2xtSWlGSTRKK0VCMm9mbmxoV1dnOHZqbU43TjJTSXZqRmtyTkIyS2EzVDVjK0hQSE1EVTI3bHlpCkRtc0Rad3A1STVIVThaaThzbnhlUkZFL0tSZHY0bXBwWndQMEdRZ0pQbktwakt2aWRKblNqdmxhTzRScGdva1R6ZkQ5b3BKNnlhaFcKaXZrR0FSaDRHazUzNXFsMlBaZkVreDhBYmY5cklHK0ZvN01rNExlL1FVcW1ldjRKOEwyUVhYdTQxNi9oOUsvMExmWVB2SnlEOWgxZwoyN0pHLzIzOTlpY0FrOHR1bkVtZnk3M24vY1lKUHhIWElDT2padm5jcUY3NXpyb1VNcDc4QWQ2WmpaVVlWL1RnOVk4aCtqckdudjF6ClRPclZwRUxMekNmTHNOVEtURmVjaGpRS2JMZkNRN241M21kTCtTS1NkSDJwZ0JXZlRKQXZndXlyc0l0WTloY3RidFVMOFBGWXZXZGgKaVMvMmtDMG9ENjRheHlMak1DSGtkdzUwRzVqcGhZME9VQmJZeVJNYW1hTGJCelpGZ3dNeVp6M2RDQ2FIOGZDTFNlWkVMbVVtMjI5bwpSU2h3RkYyY0dKTmFwOGFyRGFMV3JlNTQrU0VhTTdjc29rdEJveG1OYXMwNTJIc09VWVgxRG1GODl3YVY4S0lKN1pTanE0MnVwRzNtCmJEQlJQWHJGOHJkUWtXVlhTOVFlZGltQWlabmJoS3hPcUJIZ3hPQUV2anhUQTVQcktPUEJ2NFJ6S3B1WitFYTJNZUdlYU1BelFkUnYKM0ZNbDFpc2tWTlJJdmdDWUN4dGpjVEJSck1XbVZTWjdnV05NYUk1YndBa3Z2QkI3MDlsbnJEZlFkYzUxNkQydnRGWWY4L0h3dlVpSQo2Vk94Tkc5aEpidDhrcUFYbmZnRkxtTUZKUkRURTJPUDRGOTRMY3pCUzJFbjdLeTR6RWxrOXM2U0NiM0pUd1FKRnY2N0toKzNQZFJkCkJkZnpSdno2T2tPKzYzYkpNVHZpU1VjK2RDMFpaYlRtMDA2dldkRXlmWFJteE9FZmxDZlhtaElxS2hQQUNwQTgzblg2MnBBb2FLTTQKTFlLWGFKWm1VTnFEWk1nTFprVGlWaXZLUTVQVEdKMTlXUHRhaE4xd1ZFZ25UMzF4MDBQNndnMjJONXAvOExTbXVEWnRiYWErSHdDbApMSktCQXdnSFpGUDdrcG1MRVpMRW5EWEUxYzY4dTM3a0J2bTRKTkhpQmhqdTkwUjA3dTkwN1k2OTFVUXNEUXRLVi8vdkJkQ3ZMc3FyCko0ZnU0VUJ1VU5KVmE4anB5Z1dwSmYxRmdaeVhBcG1iZGVZZWF2NW1NUXVMTWlBdkNrWnU0YTVrNmdFQ2h5ZUZJQi9KbVhjd1VJSEEKaW5GcU9adFNPYUhxa0xqSnNiOUdSVzlWQ3VNTUlQTWJkUTN2emh0VVBueEswc2RzaCtKMTFyWEJOMVVKbEQ0bURhdmhmb2dIT1JzNApXUDRKem1vdFRHSjJhckFZSDhkaEF3RnNXWmxDSUxuYm1PRkxuc1ZtcU5EYmZtVmFlQlVvZkUzVVhLbWZ6ZUo1NmtzYlkzOWpmaFhXCm9wVmxzT0JlQ1Z3ckVkdlF1Q1N6YW5UcGhMUTRMVk15TTJIVEs0dVVCTUkrUGJOdDVDdEJzT3VrZ08zVkFSUmVPeHNPaXVsTGsyRUcKd0RHandqRGp0UmEvN1FBeWNZVVF6NXg1TUJ3R0RtTkprWVYraFZhQ2tseHY3VDkxcjRzNFUydHVFSmVOVlFjenh2K3VITzNHdDR2dQpOdTFrK3dVQWRtcXpEOVovSWlyeWxQN0VRZzBDNmpWZE1ObHJ3aFd2RmhzK2dnYm9ycUNGTUw3amd5Mmx0TnBsQ3k0RDFIOFYvN09SCmxUOUxheEZLdWQwT25ibkdiZ2hXbHpvOFBTR1RSY2dMYVc1Y3hxVHNxRUFOTmNzeXhKeTMwdWUrQ2RRczJlMEkwbVJJVUhZQVFWL1EKd0dtUlpCOU9Ud3FoR0t0VnlvdkVMOVRuWmVudHFHeU81QlhqbVl5cE8wMVhPTURQQWVWbDVrVWFqdFI4MjltQ05ZdWUzeElZc3ZOVQpKT0ZFNmdVaHNNaXZHMzJqQlM2OXR5czVpZ2xXdTFJOTRWUGQxVTJiNEt3Wk9pVDFIandlSS9NVlpFNEJ0VE9rdERLTlNEa0I4eW1ZCmx4MS9aTmZ2S3BGd1QvbmdyOHVSRGFJV3E4dnQzV2dUUUxUZ29PYWU5dmxEelA3VmhERS9aZjJuK08vNUM2S3ZHWUcvbk9laW1GMHEKVWsrR2ttL2pxUVk3SkUzTFh5Z0VValdMc0hJTVJQd3FVNGVURnBwUEd4dmphL1pwbFZYY3B2SDFGcXJ6MGhJYm01YVlSc2ZneGdNSQp5L0dkaUFSMlBJZVZYRDJ4Z3lJdURjYUNxZUlKZzB0M2MvVzdaSDRUVnRQaHR5WWxwR2t6aWJZREloNFJudW1PK2JrYUZlYU1qbEdBCjU2OVlQWk1PMXkrV3JaYXhDVjJZOVpxUlp2RDUyS0puWW8ybU1wLzh0Yy9TQmFFUmVySmNRMVNXRkRSOTYrckFwTGJjTXNiczV2TUQKQ21HWEtTYXVaRzFDQ05xVUtSeW9IZUV0T3FTVVdPSCtFS1dCR2RGc2hjbGhraXpocDBlUy82MTdoR2ZtTEZRbmhDbzVSM0dsQWJDbQpyLzV3UlJnMm5qS0FpeTMrMHptK0E0VnNJUE9BSk5MMTh1bUJtVzB0ejZRSWN0YlgrVUJsT2VGdnlvQTJTQlVQckVGUXVFc3ZiMTJqCmJxcGRaWGZFRVpSckhFZFRET0JZZFljeHZ2ckxRYnF2d1lNQkY0OEF3eEM2UGdUSEdwYmZyWVlvUUVaNjk0UUw3TjNJbzhiWm9uL3UKcmprV1ovRzlWQnJmZlRNelNpZUJlNXNnczUvcjBvcUhMUnRvMWRQKysrYzhPTzVqUlpTemxpY2Z3SlY3RkxrckFKYzNHdm5ENU81bApQbFkxRXc3UEJPc2hvZEVIY0NJUVdUby9Nc0QvUGVPYkdTZWFwZDc3VHVqbFp2VlozR0lpa2UrczBpbDNHQkYyWUZ5TllPQzZoWWtpCk04eGFPc2ZrZUo0N25lQWhJQlJGZE9YS2dKRGJkMUxSQnd1QjA3NGtMeW1ISGVvNngyTU01ZmhFY2RjZVZwUGJTTGdzWGQzanh3dFYKL2llVnEyZkg3VkQ5M01OVWZ0TUt0aVByZmUrUU1hMEhYWlFlekZicjZPSHNDd0JTUzAvUXJxVVBEUWtuVjg2dTdnK0RIUll5SUxNeQpoaThGMjg3aFdrcGk1cmhXM3QxTDU5eWxmdzhMOGJlSTRaQTBNcC9CN25TRE1ZR05NZU05N0RVNXFSU3Avb2JwNmZ1WStWUWwzMFhqCllBcEN1RmVMNHJGZndlMVlVZlhoMlgvbncwaGVNRmVldGNOenZRQlhRZ0ljaTZMK1NnRjVkZDdaWEJOazRCRzFxUzMxdkF2TGMrWDEKRjdWS1BIYzBBSk55eUgvcUhISmpQV0hXZUFwMndmdkNsZHBnTlhEWGp1aEE3d2RRNTNVOFZmcGE4MkJjc1hia29mZHlCdUN2Y3NqdQpqSVptVW9qTm1DOVR0cGtqaTJWV0xBVG1wOUk2T282QnJwL3ZmbDVDcUt0VnZNMVVDZi9xTURYejBYUGZxWXFMNHBnT29GbDJIOHFWCkorQlNCMlFCSHQ1NWJjbVFSODM4cW16Q2xYVHlPbE9sVXE0NXB1YUdIVlJrWVJIeUs5eUhycnhQdUpOVDA4TG1HRk53TGZYMEFSL2MKZmZQajlHbWQ4VmVhSjRFM3FVZE5leURtc1ZHWURJQktsRnFHbk54UXZxa2ZHdzNrRE9vd3JUM2UyakgwcjRIZ2Q1VGt6WE1YenVWMApRVjZLUWNRT0kxd2c5VTlUd0tyYXRRN1VwYWh4RFIvUWxxalR5a1F1UzdUY2F3eUVBd1VLdWNxTjIzWW1taG5GMXU4STVKZjBGVnBjCjEwcDNGdEVaTWJtMWVOL3BpU1l2alBzM0hSMTQ2SXgxOEl2MUZDaWJuUDZaWHBnY1ByVjlxVWZIQ0prS1NrL0tEdHFrNjFDeWszZGQKZ3I4MU9qQy9xWDFVTk41NVRIU1JNV2d3UFhFZU1tV3JJVGo3OTFVODl6Ti9Gc2YvUFQ2Y1pzVmZzMklGM2NiTjk0WmtSYmh5eWJrbgpka3h0elZLREd1VmRIR2lSR2dWR2hEK1lnVnVFQXp1T3lQUlhmcUxKUlBvRVVGRmEyWHN1bFhNaUtjZVVWYnJUblg4eE92VExlVTJmCjVLWER2TGp1c01qcU5ROFRXR1JlSldVbi9USWZPV1BlZ3p4bDY2QTcxTitYaG44czdOU3ZVMGJaeFBjckxjZlNna09QMFo3UlRaRnIKa1pkMzZSUGQvQnNxMzlIajcxZWdUVU0yMWliK3dPaERRZWdLL1hSb0VHWVBCamZWK0pEdzZNcFZnb3BnWStXWERNeXd1dC9QVVJYbgp0V3hHbzF5Vitnem4rNUtMNzBzbUx1UGgrL2J3cXIzS1kzNjVZeENDd3R4ZWNaNVErSGJOYkoxbXRNbzhxMHlxL2xHb1E1T0I1cEJZCnJ0c29tcmVxUzNpdHdDM21tZktUazNiS3RrakxEbFY5NExLY0dGL2Jkb2tjSXBpcHQweWFaZ1grVlEvRGJnQTZvVmhIYVRqSFNKemoKcEFLc2ZxYnJ0QzNmZmpTcERTVmRrdzVqYzJ5NWUxTjk1dkI2aFFaMTB1SmJTMGJUT0tCZ2Y1c1lVbWxlekRXZUU1SFFVTGFSWkg0awpVaXFYdlNBUnpaR1FJcUg0T3BhanJiZ0V2c2RmRU1OS1B3WTN0ZHdMWDVoc1dOSnpXSStsN0c3N1h2dmgxdEt5UkxXK3JIN2lvdUdNCktMTHNENit2Ukh6RHp5L1BMMnVia3pvdmJLL3MvK01NVVBSSkhKemNJaU9lMU9sOGNMYnJtclVUY0M5bjV0SnZrOHQ4ZnFMZlVPMjYKS1hpQWZ6ZmF6Zk9mN2NuQkM0ck5FYWlpSnZuUVEyN3psNEZSYWhqZWplNE1BV3FDU2JXN1VGM1VWdi9BemNNWXZFUHBZazcwanE2egpaYkQrek9MRnRaVkNYcVZZZ0R6UXZKdGdtbnUrMjB3Q1dPSVRSTFkxRlhDSjBWWURrUE9vZXBUOGRFZnNSRFpTbGRIeDBlUk9oanVQCk13Sk16a3ZsRkpnaTJrWGZQRkw0MFlOd2MvNDdSaXRubEpZMXB1bytXc1ZaK1N3MEZPeW5kdWRmMXQ2Q0xQejd0V01WaEpWZ0VvaHkKSXExR0pLV2VMWk93b0R1clVsS2Fqbm5RQnhoY2VOVWttdmh4Yi8rUHJhc2QwamhSZ256Z2ttWlpZL29aNGI3OU9xQ0xWdTQ1ZFpXMgpCcklPWjNpZkpPRkFER1IvdUw2WUhoSGpZU0Q0Qm1hY05ta1ZkZmVlaDVvVTljNW5mY3IxWjRNV3NiZjBBSk42Q1FIRi8zcmtsYTZ0CnpGYW9SQzQ4U2ovTnJ1ekkvKzNhWXhtZWsrYldOUFpCOHNtakZ5UzRRRXFGdjdNZGtqSDMvbjBINFUrWnF3VTJqZVNUYnUzV1hlOEsKbDE2VTZqSFJsQVhTL2Qyc1pnNXZZdjRGNWVnTktuelcyWFU5Nkk3aThLRStrczhibkxUNGhPd29QWUYzVVQ4NVVkUVRLQlFVY0ZpSApoTWZOclF1WUZYY1NXc1RPbjVTeEhsamdZZmVKRlZ2U2dCVlpTbzR0WFRxUGV2MlpMeEkwZWVkSEtmRFJvbTdhRVlCb2xjMnR2Q0FHCkw0NDg2ZHdaWWR2NDhaRktNVjFBMjZVS01CekNBWTFsTnluQWd3R2ZZQ1pRa055aU1Uc2hRb2IvTEkxaHM4OWJhZWwyc2I3MnRWOEUKNFNCMStiZXdCR2lhdi9UMjhrRUdMKzE5WGdCUjR2VHBRK2lNdDZjK1F1Tmo1b3N0OUNVeHlBRlVyenpBVWE0QW1nZytGd0M1UDFCYQprekV6K0JUVXRLQWNUc2FFcWVsVUJhR0ZkMmVHUHRCcVQ5OGFBRmNHL3V2eDZ2OU4xRmZLeE5pMGJOZU1qSHlxUC9xN2RhZkhkakJoClRtbmtZWGFjb1RvR1gzWGV5ZDJQNzN5dWhDRWlxdDkvK2lSVEtMVVZCN0tkQmQvQ21VejVVRWp6OUtmMkYxeHpBdU9tZ2pYNnhuUUkKSXY0WEM3bXhTNHFIcERRT1FpczZrSGdiWTV4d1dXUnZubVNnS09CQm1QSWlQTE50eG04dU50ZElCR1BNQWlVeHlvQVF5ZHB3Q3VEdwp4ck05ak9tbjB1bG9NR1JuU0Nldnd4bEIwVzYvZmJVS3FjbktHdkZ5ak9SQnJ5SklwNnVwRC9hY2o2dEdGRHRrUTJTUEdhUktUVE0rCmpQVDVUaGc2aXBHTmRPeExZZ0wrWmR5QTVJbkpSL3ZjU1RRK3NCc1RHdytGckhtUnhJY3NwWitrNlNtSmRHWTRLMlo2VnFSNFU2eWwKbThnZUgrckJqTXVwL05Ec2d3dUJTRElYanhPY3JoYUpETExmRk05QVZZMEs4N2RncmtyWm1SdWd3UUkzdERyOUpGZDJOSCszenRoYQp2V001eGI4bjlkZXNvdHJTd0VQWGNTOFBzbHB2K21VT3Y0UTQrY2R0VFJZK2E4ZjVMVDh2QzZvWVBFN3VsOFlhQjdKUVd6b0JMYndZCndGU05vbjdtdHUrUDV5SWJta3liS0lyckZHejNTWjZCS2N3NmticlU3NGdZd2ZOejU3K3pRWFMySFg5c21OTVZQVnRGek92MGZxdzgKVnpYd2ZEWElaZHdjK2hyUjVodDdQeUN3MlBVejVwYVVWNHZXMTlUcGVhSTZxcEJEeDhhNnV2SjhDTEg1engxV3JSdUVSRlB4alZESAo0Y1ZIR05nUXFRYWRqNi9lSUdCbXJCak9mNXR5bnpBakp5YlVEUTYzUSthbFV4U1U5SE5kWkliYlF6alJFUDBXUmtLSW93OGVQNFlnCjlBeWg3SFJYaFJnN2Q4RExyVnM3L0xwMW5BbmRUQTBSNjM0OG1GQkVzQ1lBN0drZmYwNFJaWlBmN3hodVR5aVcyWGdJU0tIK1o0aUcKS1BpTE9heTluNm1oQUJxbXo1Qjl3eWswMDdxc0V6ckJuanNVbTlQY1BDTnEraWxyUUJ2VFlFVU1uTnVRZFMybWl5NjlIcldrRE1tSQpSR0RjQjAyNGZLQ1d3SDhQNzQ3NU00ZFhuSjlpMmJBeEMxUmx4T1c1dzhaTUxBWlBjT05McFJyVTJIQ0NZdWw2aDU5eHIydndIb1BXCkZnR2loUTJHN2pRUHNJWE5uSHJRY3RwMFRVeWhwUTVna0hyVm5tTXhqMFkvU0ZzTmlGNVArMU5TbWtDQUtTK2tJR3ZvcVR0VFZKVFYKcXduUStWYk5rWDQ3OGhlYXJFNmEwOEM4R09hN2d3cHQydDJFMVdYNW1ZN0orOWNNb3N0TnIyNGJVdTNQcm9JYWt4Uk42by9MRVhZNQpNdDFkb0pNemRnOHJFYURwaThlZW9oNWwxTkVUa0Vzd1FPSlZ5Ymlpd09sckQzclVVUWFXWEFtZjZmTnpobVRxL213eEhIdDhtU2hpCnIybmpIejdOMjZsSVk5elErcW9weVJuOGZEcm9qWURkSVZveXRDcituREFtK3p0UkhpT3o0OHIvSjM5ZERkcTI0cmlBemZ4WmpnMTkKRTZNbHR6eVdST3p4K2cvaFJBdS9ESWN4SVFhdHhrc0F3Q3VRTkpTOEN6V0JaSHhhZUlydGloaGFDdlYvdjFzWTYzTEx2S2t2dkZqbQorZWFFYTNxNWxUUWVNMVZza3ZVWFBWelNSeEpzRTNZR2gyR1ArMktLL0I0TlVROFl2UXJ1ZzVXS2pBbTdXWGd5ZkV1OExqaVJJbmkvCng5bGpjdjk4bXBIVGpPaFFNWWJHb2NPeGplR1orbStRUk1SZVBuQm9wUFRleUxpaGlQNFdXaHNMUTlaYkd0MmtsenB3dXRtY3ZzTUcKZ3NVVHlZNXJ4Sk4ycTUwdmY1V2R5a05mbHovb2N6cllnZ2cyRlpvZW9TYkhZcFFoVlZRMGNUbGR4ejdMOHZtd05OWTUyK1Qxek81SQo0b21mdkF6UXVTQ1gyTTZTaU1lSk43LzRCbjEreGp0WGQxSmRrTXdsMW9oVmZpMmZVRWMrK3dqUXhvVUhTTFhsU1JOb3JETFN0VGJUClIrZWs1Q1h3V1dkWFF3UWQ2TmFiSGZBWFRRRFM3QWRwQ3VCdW9ZeTJMM1hsQlhKV2xFNlUvN2pEK1RHdVo1SlVRMVhtWnlydkQxV2gKbmVJaFpyNFE1YlhoUFB6WHJleEtiWHJEOXhEQXNoek9hV0xBUGtNdW9xU2xMSVdEZmdacnMwUmhzaGl1ckhuVytPM1NzeW1zMytZQwoyVHVDMU16ZUZqZ01DQnY0K2FFSnF0TkZNQjhKRkhIV09sU3M5NnFpR1dXazJrekpvaHhiVjdHOFpaV3ZHOEZHWTlLcllVQ1l0TG52CkJzYWNSWXFRNHg3WGhubG0wOVN6a1k5OHlwUVVGTHNxVkg5T0VMbnhaKzZrRmxZa1NxSDh5TlVndGVhUCtlbElHQ0ViQ3B4UFptbVEKOFBnZFd3b1BSMWEyU2tlWGdZT0JIS2lua1Y1a21NcHFra241Z0pBSm9vNjJHNjFUWUJhVUJuN1ZNbVpnQ2JOU3FRNUE1M1FUZWc2Nwo5SExjNTB6T0d1VmZPSHE5cWVPVktTL0ZLSmc2ZW82b0dSckU3K2Y2NXIwYVZVdS9kU045M0hvaWJNUDBhekJ3QTQ0SmQyUGMvYXZXCjlVWmlEZWIyY2JrWVlQaGxVUlNXdXYxckk1dUZ6RE4zeCtBcU1qREtiNFA0ZFcwOENjTUl1UmFhSUs0ZSt5dGJOYkJ3QzhWY2Q5UGkKOWc5WlBKQUxsQ1hnaUw1TnpCVjFDZXZNK3RjbmkrMGVZQklMVi9DTGJaYjBoWDZYWXdxdTNyWUJwdk5jbEdBZS9rcjdGWjAwaDd3SwpEN2dwZzdBNjlybkRzSC9zQ0xFVXg3bko3QXFnRlllc1BBZFlTVG1lcnlOYkVqZEVWQXpzMkFDWGFZV2RkM1NDbFF1WVlxNVBjZE5sCmFHVjUvQTR6M3JkaEMvSmg0by8xa2RDdkNyd1BrcVl6NmJoS2lCMzFBNWpGVTVWck0wUGdMNDJVVXoxVWU2RUl4aWlGbXVjYndiTGIKRTBEYzVvQW9DcjB4WGFVZTNVcGJJcnQvdG9WZXZpNGJlVE1qNzBrcTVqM2IrQ0s1YkNYeldOSk5VWTVEWWxodnFLbTVhaG9wWVJiNQpFalg0emV0d3VKMk9BUVduMTJzSjcydzlESGZaZXhWb0xsenRpL0tNSi9aM1c4R2lnbHpDQ1czaitWRmhlRHRpVExaL2ZpVnV3Z1dCCm1RWjN0c1hEekovb3hVcnRCVmYwTVFCbDdkK1FvNHpsSjRZT2FCQjEvbHovOVRVV1dhYW1vZVR4Zk9QSDJheThEaWFkMG5WYVdUTm8KNzhCZVJjRnl4WlhHNU9SN0FYclVvM1c5MmFySmNWVVZmQnV4K29tbXA4WmJDNWt2aURkNlUzQ0dLcGhCWnY0TU5PM2JVT1FrRGQvaQpvbEFwVmJwNE15R3lyZkRCdm5XYjNxeG5Ed3Njd3RTNU1NV1RrQ3BBSThGVG1GbzI5dGFKNS9NTFpYd2dWOGNIRDBXR1crdVYzcmJVCnliS0NDbzlKcVN5T3lVdzhYcXY2MCtMNk1oUUtUNXhCYnBEK1ZhVDBlaVd6SzRuY1RhZWxiRHV1NXUrRFhsK0hLaS8wOS9xQWVHUzYKZC9kS1VpWGIwZ3A4L3F3ck8xNXdpSUpVS3FNMjRuZTZ1L0NuQTNJaE1HZ2RjUUVRS0ZLMHNLS3hpUzN2UjBuTzI4ekR5dWNnWmNjVQpiNG9tMmlncE8rT01Md1RNL2xQcmFPK20rdWFyaFFreU92cnZMN0FXR1E0QlRHbitKc1FKM0l1V0s4ajc3M1liVDN2VSsxWkJVcWtXCm96QVZwNnZNa3VGNUgzWTYrenpEcmFuUDloN09lR0JoZU0vc0gya2N1V2Q0VDJYelp3cGkzcHBXSExtU2VoSGJTRFRzbmxQY3IzS2sKVUpFWFBDUGJyZHJDUnNaekZRQ1JjdXR5aEp0RzV6Z2xtUzFsTkpZOVdzRHh2aDlQSlBiZmtMSU9jeFBtRU9KVk5SUzZvNFlOcnVzcgpEUGRWUFlvMkdSRThEUUhONDNBeTk1dnIrR0RGQ3ZlSVVYT2IrQk9aY09vUlZwTWhkUFhKTHJUVE1XcElQMnNNc0txUHVSdktKaEphCmc4U3hibXM0SUllY2JwMDdUVE0zeW00dzdZYVN1dk0zTTN4ODIySFB2aFhFenlyRnFrYStpZDl0YkE4YVVTbHAza0d0cndDVDlIb2sKaGFtQ3MxN2dRZG85U09tcUlkTDNtRytsRVhVV1Z1SWNrZHdaTm5MMXVvcm81ZU9oNXpEeDZIWGF1cm8yNCtQQmhIQWs2ckNBa2QwcwpJOXBWUUNMbTNzUHN5dXhSemJmRHJHUGx5dmxVaU1EUDBRdk9LVDdOMzJ2YUhmaXBmc1dSbEZQU3hjL0FiSk4rMVhQSTZIY2pFOXhuCi82dGJsSDR1K3VaeFVOc0IvR25DTkY4NGd4OXF5alMyMmFxV0E3cUhTVFA1MDBqRGNVRGFBZGJWa0p2YjRuYTJ0UnJHZGZRT0lXc3IKZmpFUVlZYnJzdFpzRFNRV2FwTk9LbEFSc1JaSDJFaGk2ZE4wV3ZyZVc1cGNoV2ZPU0NiRGpPS0M2bkdnT2VMME5VRmM2WFBvOVlKVQpWTUNuNlNYSnYra3lTYkxRUVhVL1NCellIUUY5MG4yUktUeDYwQ24yM2EvcVlyRi9kSTZMbFViUkZha1BmTEZhY1dPdlZyc280azNlCkNtYk9QU2hKQVE4S2ZNTGZ0czlOdERQdGlpczFZck5GT1h6OWh1QllWeHpkeTdMU2drQWlibWhGdHpGY3pBK0pDaW05Y3NHb1lOaG4KQThvVlViMUR6YXlXZnpMWUExWVlnZzBIVy9qQ1doZFoxb2pUVFk0N0NsVnBQSk5NWXc4am9YdEluZGhsNHhCYjRYVkZ1MlYyMVZYVwpFZ3RvUUxtNHZlSlZaQm5jSHRHcEY3d3FTTXRNdFhJSitRMC9MbWx3MUJZcm54OUVFU1lsSVA2b3VkT3pUZS9XWHlxcDJmSzdzUGxICjgxT1hBbkxnWkRpZjJEU2RLam90Nm5ZcVp0MUF3TWpYajY1WWJGR0M3anppMXY5UGhhV1M5MHhxTkhiY0xWKzRBbVhHU2dEcG8yWDYKSHNTV2RHbFlVODNQRkZXTHJzNmNFZndSTTJpaGQ2ZElzUlI1bEZFdDhYNmpYdmhLTXViQ1JCSGUvRURJcVlYRmpiOWgzVlZNVEdZRwppUVExQzIvRnIrZGwwbFp0Zjg0eVp5QmJkblBWMGtoUkNyK0wwaW9CYndEd2J0ZmxpTERBclV6Zjg5OHVxQjlrVnNibnBkVXM2VkdvCnduR0dYYVVQaHBpNWtVSVNSRnRJMm5LYXEwWXFCcktab0I5OE5kdXppNUx1NFFzREYrbk9MMDU3ZUNHSGNmQVhia05qR2oxYjA3WFYKM2hXekNIN1IrQTFNYit3aEQ5WmI2NUFYakt5andFcDZVT3FVRkJtenIxMGo0VGY5d2o4YkhBSEI1YVBnaUgvb2dIYkUrZ20xT2hFVwpWblVJbmdubzgzOUtjUUN2RGxUWnJvbEVBWEh5eXVEdGhYRDJhQVBoQ0xRaElMVUxaMUdvVTZVPTwveGVuYzpDaXBoZXJWYWx1ZT48L3hlbmM6Q2lwaGVyRGF0YT48L3hlbmM6RW5jcnlwdGVkRGF0YT48L3NhbWwyOkVuY3J5cHRlZEFzc2VydGlvbj48L3NhbWwycDpSZXNwb25zZT4=";


    /**
     * The remote Ip Address. (i.e., WebRequest RemoteIpAddress.) for testing proposes.
     */
    private final String ipAddress = "192.172.0.0";

    /**
     * matadata Url, for testing proposes.
     */
    private final String metadataUrl = "http://localhost:8080/EidasNode/ServiceMetadata";

    /**
     * Methods that builds a {@link IAuthenticationRequest}
     *
     * @return the {@link IAuthenticationRequest}
     */
    private IAuthenticationRequest buildIAuthenticationRequest() {
        final EidasAuthenticationRequest.Builder eidasAuthenticationRequestBuilder = EidasAuthenticationRequest.builder();

        eidasAuthenticationRequestBuilder.id(TestingConstants.SAML_ID_CONS.toString())
                .destination("destinationUrl")
                .issuer(TestingConstants.REQUEST_ISSUER_CONS.toString())
                .citizenCountryCode(TestingConstants.CITIZEN_COUNTRY_CODE_CONS.toString())
                .assertionConsumerServiceURL(TestingConstants.ASSERTION_URL_CONS.toString());

        return eidasAuthenticationRequestBuilder.build();
    }

    /**
     * Test method for {@link MessageLoggerUtils#getConnectorRedirectUrl()} when isSpecificConnectorJar is true. Must succeed.
     */
    @Test
    public void getConnectorRedirectUrlTrue() {
        ApplicationContext mockApplicationContext = mock(ApplicationContext.class);
        Mockito.when(mockApplicationContext.getBean(anyString())).thenReturn(true);
        ReflectionTestUtils.setField(BeanProvider.class, "CONTEXT", mockApplicationContext);

        MessageLoggerUtils messageLoggerUtils = new MessageLoggerUtils();
        messageLoggerUtils.getConnectorRedirectUrl();
    }

    /**
     * Test method for {@link MessageLoggerUtils#getConnectorRedirectUrl()} when isSpecificConnectorJar is false. Must succeed.
     */
    @Test
    public void getConnectorRedirectUrlFalse() {
        ApplicationContext mockApplicationContext = mock(ApplicationContext.class);
        Mockito.when(mockApplicationContext.getBean(anyString())).thenReturn(false);
        ReflectionTestUtils.setField(BeanProvider.class, "CONTEXT", mockApplicationContext);

        Map<String, String> mockMap = mock(Map.class);
        ReflectionTestUtils.setField(PropertiesUtil.class, "propertiesMap", mockMap);

        MessageLoggerUtils messageLoggerUtils = new MessageLoggerUtils();
        messageLoggerUtils.getConnectorRedirectUrl();
    }

    /**
     * Test method for {@link MessageLoggerUtils#getProxyServiceRedirectUrl()} when isSpecificProxyServiceJar is true. Must succeed.
     */
    @Test
    public void getProxyServiceRedirectUrlTrue() {
        ApplicationContext mockApplicationContext = mock(ApplicationContext.class);
        Mockito.when(mockApplicationContext.getBean(anyString())).thenReturn(true);
        ReflectionTestUtils.setField(BeanProvider.class, "CONTEXT", mockApplicationContext);

        MessageLoggerUtils messageLoggerUtils = new MessageLoggerUtils();
        messageLoggerUtils.getProxyServiceRedirectUrl();
    }

    /**
     * Test method for {@link MessageLoggerUtils#getProxyServiceRedirectUrl()} when isSpecificProxyServiceJar is false. Must succeed.
     */
    @Test
    public void getProxyServiceRedirectUrlFalse() {
        ApplicationContext mockApplicationContext = mock(ApplicationContext.class);
        Mockito.when(mockApplicationContext.getBean(anyString())).thenReturn(false);
        ReflectionTestUtils.setField(BeanProvider.class, "CONTEXT", mockApplicationContext);

        Map<String, String> mockMap = mock(Map.class);
        ReflectionTestUtils.setField(PropertiesUtil.class, "propertiesMap", mockMap);

        MessageLoggerUtils messageLoggerUtils = new MessageLoggerUtils();
        messageLoggerUtils.getProxyServiceRedirectUrl();
    }

    /**
     * Test method for {@link MessageLoggerUtils#getIAuthenticationProxyRequest(byte[])}. Must succeed.
     */
    @Test
    public void getIAuthenticationProxyRequest() throws EIDASSAMLEngineException {
        MessageLoggerUtils spyMessageLoggerUtils = Mockito.spy(MessageLoggerUtils.class);
        spyMessageLoggerUtils.setSamlEngineProxyInstanceName(TestingConstants.SAML_INSTANCE_CONS.toString());
        spyMessageLoggerUtils.setNodeProtocolEngineFactory(DefaultProtocolEngineFactory.getInstance());
        spyMessageLoggerUtils.setCountryCode("BE");

        ProtocolEngineI mockProtocolEngineI = mock(ProtocolEngineI.class);
        Mockito.when(spyMessageLoggerUtils.getProxyServiceSamlEngine()).thenReturn(mockProtocolEngineI);
        Mockito.when(mockProtocolEngineI.unmarshallRequestAndValidate(any(byte[].class), anyString())).thenReturn(buildIAuthenticationRequest());

        final byte[] samlObj = EidasStringUtil.decodeBytesFromBase64(SAML_TOKEN_REQUEST);
        spyMessageLoggerUtils.getIAuthenticationProxyRequest(samlObj);
    }

    /**
     * Test method for {@link MessageLoggerUtils#getIAuthenticationResponse(byte[])}.
     *
     * Must succeed.
     */
    @Test
    public void getIAuthenticationResponse() throws EIDASSAMLEngineException {
        MessageLoggerUtils messageLoggerUtils = new MessageLoggerUtils();

        final byte[] samlObj = EidasStringUtil.decodeBytesFromBase64(SAML_TOKEN_RESPONSE);
        IAuthenticationResponse iAuthenticationResponse = messageLoggerUtils.getIAuthenticationResponse(samlObj);

        Assert.assertEquals("_7POlm0XG6RUlrv67ArCVMe4cjc4IjIO5S2fe74-0yYbPRqbjJYl-v2hE4l6sqA2", iAuthenticationResponse.getId());
        Assert.assertEquals("_BWujh-SYHdY7qT35CXZ8y.yk5tSK793zQoiavTqXe.i_AuVw0f9RTOEQOihenSv", iAuthenticationResponse.getInResponseToId());

        String statusCode = iAuthenticationResponse.getStatusCode();
        Assert.assertEquals("urn:oasis:names:tc:SAML:2.0:status:Success", statusCode);
    }

    /**
     * Test method for {@link MessageLoggerUtils#getEntityId(String, ProtocolEngineI)}. Must succeed.
     */
    @Test
    public void getEntityId() throws EIDASMetadataException {
        MessageLoggerUtils spyMessageLoggerUtils = Mockito.spy(MessageLoggerUtils.class);
        spyMessageLoggerUtils.setSamlEngineProxyInstanceName(TestingConstants.SAML_INSTANCE_CONS.toString());
        spyMessageLoggerUtils.setNodeProtocolEngineFactory(DefaultProtocolEngineFactory.getInstance());

        MetadataFetcherI mockMetadataProcessor = mock(MetadataFetcherI.class);

        EntityDescriptor entityDescriptor = new EntityDescriptorBuilder().buildObject();
        Extensions extensions = new ExtensionsBuilder().buildObject();
        EntityAttributes entityAttributes = new EntityAttributesBuilder().buildObject();
        Attribute loa = new AttributeBuilder().buildObject();
        loa.setName(MetadataUtil.LEVEL_OF_ASSURANCE_NAME);
        XSString xsString = new XSStringBuilder().buildObject(XSString.TYPE_NAME);
        xsString.setValue(LevelOfAssurance.HIGH.getValue());
        loa.getAttributeValues().add(xsString);
        entityAttributes.getAttributes().add(loa);
        extensions.getUnknownXMLObjects().add(entityAttributes);
        entityDescriptor.setExtensions(extensions);
        EidasMetadataParametersI metadataParameters = MetadataUtil.convertEntityDescriptor(entityDescriptor);

        when(mockMetadataProcessor.getEidasMetadata(anyString(), Matchers.<MetadataSignerI>any(), Matchers.<MetadataClockI>any() )).thenReturn(
                metadataParameters);

        spyMessageLoggerUtils.setMetadataFetcher(mockMetadataProcessor);

        spyMessageLoggerUtils.getEntityId(metadataUrl, spyMessageLoggerUtils.getProxyServiceSamlEngine());
    }

    /**
     * Test method for {@link MessageLoggerUtils#getConnectorEntityId(String)}. Must succeed.
     */
    @Test
    public void getConnectorEntityId() {
        MessageLoggerUtils spyMessageLoggerUtils = Mockito.spy(MessageLoggerUtils.class);
        spyMessageLoggerUtils.setSamlConnectorServiceInstance(TestingConstants.SAML_INSTANCE_CONS.toString());
        spyMessageLoggerUtils.setNodeProtocolEngineFactory(DefaultProtocolEngineFactory.getInstance());

        spyMessageLoggerUtils.getConnectorEntityId(metadataUrl);
    }

    /**
     * Test method for {@link MessageLoggerUtils#getProxyServiceEntityId(String)}. Must succeed.
     */
    @Test
    public void getProxyServiceEntityId() {
        MessageLoggerUtils spyMessageLoggerUtils = Mockito.spy(MessageLoggerUtils.class);
        spyMessageLoggerUtils.setSamlEngineProxyInstanceName(TestingConstants.SAML_INSTANCE_CONS.toString());
        spyMessageLoggerUtils.setNodeProtocolEngineFactory(DefaultProtocolEngineFactory.getInstance());

        spyMessageLoggerUtils.getProxyServiceEntityId(metadataUrl);
    }

    /**
     * Test method for {@link MessageLoggerUtils#retrieveConnectorAttributes()}. Must succeed.
     */
    @Test
    public void retrieveConnectorAttributes() {
        MessageLoggerUtils spyMessageLoggerUtils = Mockito.spy(MessageLoggerUtils.class);
        ConnectorControllerService connectorControllerService = new ConnectorControllerService();
        AUCONNECTOR auConnector = new AUCONNECTOR();
        AUCONNECTORSAML auConnectorSaml = new AUCONNECTORSAML();

        auConnectorSaml.setSamlServiceInstance(TestingConstants.SAML_INSTANCE_CONS.toString());
        auConnectorSaml.setNodeProtocolEngineFactory(DefaultProtocolEngineFactory.getInstance());
        auConnector.setSamlService(auConnectorSaml);
        connectorControllerService.setConnectorService(auConnector);
        spyMessageLoggerUtils.setConnectorControllerService(connectorControllerService);

        spyMessageLoggerUtils.retrieveConnectorAttributes();
    }

    /**
     * Test method for {@link MessageLoggerUtils#retrieveProxyServiceAttributes()}. Must succeed.
     */
    @Test
    public void retrieveProxyServiceAttributes() {
        MessageLoggerUtils spyMessageLoggerUtils = Mockito.spy(MessageLoggerUtils.class);
        ServiceControllerService serviceControllerService = new ServiceControllerService();
        AUSERVICE auService = new AUSERVICE();
        AUSERVICESAML auServiceSaml = new AUSERVICESAML();

        auServiceSaml.setSamlEngineInstanceName(TestingConstants.SAML_INSTANCE_CONS.toString());
        auServiceSaml.setNodeProtocolEngineFactory(DefaultProtocolEngineFactory.getInstance());
        auService.setSamlService(auServiceSaml);
        serviceControllerService.setProxyService(auService);
        spyMessageLoggerUtils.setServiceControllerService(serviceControllerService);

        spyMessageLoggerUtils.retrieveProxyServiceAttributes();
    }

    /**
     * Test method for {@link MessageLoggerUtils#isLogMessages()}. Must succeed.
     */
    @Test
    public void isMessageLogged() {
        MessageLoggerUtils messageLoggerUtils = new MessageLoggerUtils();
        messageLoggerUtils.setLogMessage(true);
        boolean actual = messageLoggerUtils.isLogMessages();
        Assert.assertTrue(actual);
    }
}